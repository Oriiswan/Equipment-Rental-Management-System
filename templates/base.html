<!DOCTYPE html>
{% load static %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Equipment Rental{% endblock %}</title>
    <link href="{% static 'css/output.css' %}" rel="stylesheet">
    <link href="{% static 'css/custom.css' %}" rel="stylesheet">
</head>
<body class="bg-gray-50 pl-[256px] pt-[80px]">
    <header class="bg-white shadow-md fixed w-full z-50 top-0">
        <div class="flex items-center justify-between px-3 py-3 h-20">
          <div class="flex items-center">
            <button class="text-gray-500 focus:outline-none lg:hidden">
              <i class="fas fa-bars"></i>
            </button>
            <h2 class="text-2xl font-semibold text-gray-800 ml-4">{% block 'nav' %}{% endblock 'nav' %}</h2>
          </div>
          <div class="flex items-center">
            <div class="relative">
              
            </div>
          
          </div>
        </div>
      </header>
   
    {%include 'includes/sidebar.html'%}
    {% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}
    <main class=" w-full">
        {% include 'includes/messages.html' %}
        {% block 'content' %}{% endblock 'content' %}
        
    </main>
    
    {% include 'includes/footer.html' %}
    
    <script>
        const dropdownButton = document.getElementById('dropdownButton');
        const dropdownMenu = document.getElementById('dropdownMenu');
        const chevron = document.getElementById('chevron');
        const selectedText = document.getElementById('selectedText');
        const dropdownItems = document.querySelectorAll('.dropdown-item');

        let isOpen = false;
        let selectedValue = 'newest';

        const sortLabels = {
            'newest': 'Newest First',
            'oldest': 'Oldest First',
            'today': 'Today',
            'week': 'This Week',
            'month': 'This Month',
            'year': 'This Year'
        };

        // Toggle dropdown
        dropdownButton.addEventListener('click', () => {
            isOpen = !isOpen;
            dropdownMenu.classList.toggle('hidden', !isOpen);
            chevron.classList.toggle('rotate-180', isOpen);
        });

        // Handle item selection
        dropdownItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.stopPropagation();
                
                // Remove active state from all items
                dropdownItems.forEach(i => {
                    i.classList.remove('bg-blue-50', 'text-blue-700');
                    i.classList.add('text-gray-700');
                    const dot = i.querySelector('.w-2.h-2');
                    if (dot) dot.remove();
                });
                
                // Add active state to selected item
                item.classList.add('bg-blue-50', 'text-blue-700');
                item.classList.remove('text-gray-700');
                const dot = document.createElement('div');
                dot.className = 'ml-auto w-2 h-2 bg-blue-600 rounded-full';
                item.appendChild(dot);
                
                // Update selected value and text
                selectedValue = item.dataset.value;
                selectedText.textContent = `Sort by Date: ${sortLabels[selectedValue]}`;
                
                // Close dropdown
                isOpen = false;
                dropdownMenu.classList.add('hidden');
                chevron.classList.remove('rotate-180');
                
                console.log('Selected sort:', selectedValue);
            });
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!dropdownButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
                isOpen = false;
                dropdownMenu.classList.add('hidden');
                chevron.classList.remove('rotate-180');
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
    // When modal opens
    document.body.style.overflow = 'hidden';
    
    // When modal closes (either via confirm or cancel)
    function closeModal() {
        document.body.style.overflow = '';
    }
    
    // Attach to cancel button
    document.querySelector('a[href="/booking/list/"]').addEventListener('click', closeModal);
    
    </script>{% block scripts %}{% endblock %}
</body>
</html>